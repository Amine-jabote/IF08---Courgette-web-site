<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <title>Gratin de Courgettes au Ch√®vre - IF08</title>
    <link href="heroes.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <header class="my-3 py-2">
<h1 id="title" class="display-4 text-success mb-4 font-weight-bold text-center">Gratin de Courgettes au Ch√®vre</h1>
<img src="https://assets.afcdn.com/recipe/20200430/110231_w600.jpg"
     alt="Gratin de courgettes au ch√®vre"
     class="img-fluid rounded shadow-lg d-block mx-auto">
    </header>

    <section class="container my-5">
  <h2 class="text-center mb-4">ü§î Le saviez-vous ?</h2>
  <div class="alert alert-info shadow-sm" role="alert">
    Le gratin est un des plats les plus populaires en France ! Le mot vient du verbe "gratter", car on raclait le fond croustillant du plat. App√©tissant, non ?
  </div>
</section>


    <section class="my-5">
      <h2 class="text-center mb-4">üìä NutriScore</h2>
      <div class="container">
        <div class="row justify-content-center">
          <!-- Card pour afficher la note -->
          <div class="col-12 col-md-6 col-lg-4">
            <div class="card shadow-sm">
              <div class="card-body text-center">
                <h5 class="card-title">Note globale :</h5>
                <h3 class="text-primary"><strong>"note moyenne"</strong></h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="my-5">
      <h2 class="text-center mb-4">Ingr√©dients</h2>
      <div class="row" id="productList"></div>
    </section>

    <section class="my-5">
      <h2 class="text-center mb-4">Pr√©paration</h2>
      <div class="container">
        <ul class="list-group list-group-flush preparation-steps">
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step1">
            <label for="step1" class="form-check-label">
              Laver les courgettes, les couper en rondelles pas trop √©paisses et faire revenir dans l'huile d'olive jusqu'√† ce qu'elles soient tendres, une dizaine de minutes, en remuant
            </label>
          </li>
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step2">
            <label for="step2" class="form-check-label">
              Dans un bol, battre : la cr√®me et l'oeuf
            </label>
          </li>
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step3">
            <label for="step3" class="form-check-label">
              Ajouter le sel, le poivre, muscade et les gousses d'ail finement √©minc√©es
            </label>
          </li>
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step4">
            <label for="step4" class="form-check-label">
              Une fois tendres, √©goutter un peu les courgettes du surplus d'huile et les mettre dans un petit plat √† gratin
            </label>
          </li>
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step5">
            <label for="step5" class="form-check-label">
              Verser dessus la pr√©paration √† la cr√®me
            </label>
          </li>
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step6">
            <label for="step6" class="form-check-label">
              Disposer sur le plat des rondelles de ch√®vres et un peu de gruy√®re r√¢p√©e
            </label>
          </li>
          <li class="list-group-item d-flex align-items-start">
            <input type="checkbox" class="form-check-input me-2 mt-1" id="step7">
            <label for="step7" class="form-check-label">
              Enfourner entre 180 et 200¬∞C pour 30 mn, le flan doit avoir pris
            </label>
          </li>
        </ul>
      </div>
    </section>

    <section class="container my-5">
  <h2 class="text-center mb-4">üí° Conseils & Astuces</h2>
  <div class="text-center">
    <button class="btn btn-outline-secondary mb-3" type="button" data-bs-toggle="collapse" data-bs-target="#conseilsCollapse">
      Voir les conseils
    </button>
    <div class="collapse" id="conseilsCollapse">
      <div class="card card-body text-start">
        <ul>
          <li>Remplace la cr√®me par du yaourt grec pour une version plus l√©g√®re.</li>
          <li>Ajoute une pinc√©e de curcuma pour relever les saveurs !</li>
          <li>Gratiner avec un m√©lange de fromages pour plus d‚Äôonctuosit√©.</li>
        </ul>
      </div>
    </div>
  </div>
</section>


    <footer class="bg-light py-3 mx-5 mb-4 rounded">
      <div class="container text-center">
        <p>
          <a href="https://www.marmiton.org/recettes/recette_gratin-de-courgettes-au-chevre_25581.aspx" 
             title="Source" class="text-decoration-none text-primary">
            Source recette de la Marmiton
          </a>
        </p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>


    <section class="container my-5">
  <h2 class="text-center mb-4">üí¨ Laissez votre avis</h2>
  <form class="mx-auto" style="max-width: 600px;">
    <div class="mb-3">
      <label for="nom" class="form-label">Votre nom</label>
      <input type="text" class="form-control" id="nom" placeholder="Jean Dupont">
    </div>
    <div class="mb-3">
      <label for="commentaire" class="form-label">Votre suggestion ou remarque</label>
      <textarea class="form-control" id="commentaire" rows="3" placeholder="Ajoutez du thym, c'est d√©licieux !"></textarea>
    </div>
    <button type="submit" class="btn btn-success">Envoyer</button>
  </form>
</section>


    <script>
      const ingredients = [
        {"nom":"courgette", "quantite":"1 ou 2 moyennes", "code_barres":"8445509071458", "nutriscore":"A"},
        {"nom":"gruy√®re r√¢p√©", "quantite":"NA", "code_barres":"3250390547372", "nutriscore":"D"},
        {"nom":"poivre", "quantite":"NA", "code_barres":"3166296203116", "nutriscore":"NA"},
        {"nom":"sel", "quantite":"NA", "code_barres":"3183280000728", "nutriscore":"NA"},
        {"nom":"muscade", "quantite":"NA", "code_barres":"3166291543262", "nutriscore":"NA"},
        {"nom":"cr√®me √©paisse", "quantite":"10 cl", "code_barres":"3155250001554", "nutriscore":"D"},
        {"nom":"gousses d'ail", "quantite":"2", "code_barres":"3700103800312", "nutriscore":"NA"},
        {"nom":"oeuf", "quantite":"1", "code_barres":"3245412846991", "nutriscore":"A"},
        {"nom":"b√ªchette de ch√®vre", "quantite":"1/2", "code_barres":"3394230003144", "nutriscore":"D"},
        {"nom":"huile d'olive", "quantite":"NA", "code_barres":"8002470023727", "nutriscore":"B"}
      ];

      const API_ROOT    = "https://world.openfoodfacts.net/api/v2/product/";
      const FIELDS      = "product_name,nutriscore_grade,image_front_small_url";
      const DEFAULT_IMG = "https://via.placeholder.com/140x140?text=Image";
      const NUTRI_REGEX = /^[a-e]$/;

      async function fetchProduct(barcode) {
        try {
          const res = await fetch(`${API_ROOT}${barcode}?fields=${FIELDS}`, { mode: "cors" });
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          const json = await res.json();
          return json.status === 1 ? json.product : null;
        } catch (err) {
          console.warn(`OFF ‚Äì erreur sur ${barcode}`, err);
          return null;
        }
      }

      function addIngredientCard(ingredient, product) {
        const displayName = ingredient.nom || product?.product_name || "Nom inconnu";
        const imgURL = product?.image_front_small_url || DEFAULT_IMG;
        const grade = (product?.nutriscore_grade || ingredient.nutriscore || "").toLowerCase();
        const gradeLetter = NUTRI_REGEX.test(grade) ? grade.toUpperCase() : "Inconnu";
        const gradeImg = NUTRI_REGEX.test(grade)
          ? `<img src="https://static.openfoodfacts.org/images/attributes/dist/nutriscore-${grade}.svg"
                   alt="Nutri-score ${gradeLetter}" style="height:32px;margin-left:.3rem;">`
          : "";

        const col = document.createElement("div");
        col.className = "col-12 col-md-6 col-lg-3 mb-4";

        col.innerHTML = `
          <div class="card h-100 text-center p-3 shadow-sm">
            <img src="${imgURL}" class="card-img-top img-fluid mx-auto d-block rounded"
                 style="max-height:140px;object-fit:contain;" alt="${displayName}">
            <div class="card-body">
              <h5 class="card-title">${displayName}</h5>
              ${ingredient.quantite !== "NA"
                ? `<p class="card-text fw-light mb-2">Quantit√© : ${ingredient.quantite}</p>` : ""}
              <p class="card-text mb-0">
                Nutri-score : <strong>${gradeLetter}</strong> ${gradeImg}
              </p>
            </div>
          </div>`;
        document.getElementById("productList").appendChild(col);
      }

      async function initIngredientSection() {
        const listElt = document.getElementById("productList");
        listElt.innerHTML = "";

        for (const ing of ingredients) {
          const product = await fetchProduct(ing.code_barres);
          addIngredientCard(ing, product);
        }
      }

      document.addEventListener("DOMContentLoaded", initIngredientSection);
    </script>
  </body>
</html>
